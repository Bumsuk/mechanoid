<h2>Overview</h2>

<p>The Mechanoid Service Client DSL is a language to describe and generate code for JSON over REST services on Android.</p> 

<p>The syntax of the DSL is designed in such a way that closely models HTTP methods such as GET, PUT and POST and DELETE.</p>

<h2>Usage Example</h2>
<p>In order to effectively describe how to use the Service Client DSL, 
we will use an imaginary Books service, the following section defines the 
service specification.</p>

<h3>Books Service Specification</h3>
<p>The following table defines methods of the book service.</p>
<table width="100%">
	<thead>
		<tr>
			<th>METHOD</th>
			<th>URL</th>
			<th>EXAMPLE BODY</th>
			<th>EXAMPLE RESPONSE</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>GET</td>
			<td>http://books.example.com/books</td>
			<td>N/A</td>
			<td>
			   <pre>
[
	{
		"id":1,
		"title":"qux",
		"author":"qux"
	},
	{
		"id":2,
		"title":"qux",
		"author":"qux"
	}
]			   			   
			   </pre>
			</td>
		</tr>
		<tr>
			<td>GET</td>
			<td>http://books.example.com/books/:id</td>
			<td>N/A</td>
			<td>
			   <pre>
{
	"id":1,
	"title":"qux",
	"author":"qux"
}		   			   
			   </pre>
			</td>
		</tr>
		<tr>
			<td>POST</td>
			<td>http://books.example.com/books</td>
			<td>
			   <pre>
{
	"title":"qux",
	"author":"qux"
}		   			   
			   </pre>			
			</td>
			<td>
			   <pre>
{
	"success": true,
	"status_message": "book created",
	"book_id":1
}		   			   
			   </pre>
			</td>
		</tr>
		<tr>
			<td>PUT</td>
			<td>http://books.example.com/books/:id</td>
			<td>
			   <pre>
{
	"title":"qux",
	"author":"qux"
}		   			   
			   </pre>			
			</td>
			<td>
			   <pre>
{
	"success": true,
	"status_message": "book updated"
}		   			   
			   </pre>
			</td>
		</tr>
		<tr>
			<td>DELETE</td>
			<td>http://books.example.com/books/:id</td>
			<td>N/A</td>
			<td>
			   <pre>
{
	"success": true,
	"status_message": "book deleted"
}		   			   
			   </pre>
			</td>
		</tr>
	</tbody>
</table>

<h3>The Mechanoid Service DSL File</h3>
<p>With the Mechanoid Service DSL we can describe the book service in a succinct syntax that closely models the service in the following example.</p>

[mechnet]
package com.example.books.net

client BookService "http://books.example.com" {
    get getBooks "/books" {
        response Book[]
    }

    get getBook "/books/:id" {
        response Book
    }

    put updateBook "/books" {
        body Book
        response {
            success:boolean,
            status_message:String
        }
    }

    post createBook "/books" {
        body Book
        response {
            success:boolean,
            status_message:String,
            book_id:int
        }
    }

    delete deleteBook "/books/:id" {
        response {
            success:boolean,
            status_message:String
        }
    }
}
[/mechnet]

<p>In the example, we first declare a package which effectively specifies where code should be generated 
and what the package name of generated code should be. Next we define a client with the name of BookService 
using the client keyword which defines a block where we can define our service methods, following the identifier 
we provide a URL which is the root of the URL for all our service methods.</p>
<p>In the client block we define the service methods which are typical CRUD method calls 
such as getBook, updateBook, etc. The Service Client DSL allows us to specify service methods, 
using the keywords get, put, post and delete, followed by an identifier, followed by a path into the service, 
which ultimately follows the URL given by the client declaration. Looking at the path for getBook, 
we can see the token <b>:id,</b> this allows us to define a slug in the url that can be set later with the generated code.</p>

<p>In the example we see the entity Book used a few times, this is an entity we are yet to define, 
we can add it anywhere in the file, or in another file if we wish, the following example shows how to define 
the Book entity.</p>

[mechnet]
type generate Book {
	id:integer,
	title:String,
	author:String
}
[/mechnet]

<h3>The generated Service Client in Action</h3>
<p>Defining a service using the Service Client DSL generates codes behind the scenes which we can use in our application 
to access the service in a consistent manner according to its specification, the following example shows the generated API in action.</p>

[java]
BookService service = new BookService(new HttpRequestHelper(new DefaultHttpClient()));
      
// Create a new book

Book book = new Book();
book.setAuthor("Joe Bloggs");
book.setTitle("Qux");
      
WebResponse<CreateBookResponse> response = service.createBook(new CreateBookRequest(book));

// TODO Ensure expected status code, for example 200
int httpStatusCode = response.getStatusCode();

int newBookId = response.getContent().getBookId();

// Get a list of books
WebResponse<GetBooksResponse> getBooksResponse = service.getBooks(new GetBooksRequest());

Book[] books = getBooksResponse.getContent().getBooks();
[/java]

<p>The rest of this document will outline the features available in the Mechanoid Service Client DSL.</p>

<h2>Features</h2>



